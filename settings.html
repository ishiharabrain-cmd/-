<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨­å®š - ã„ã¤ã§ã‚‚ã‚µãƒãƒ¼ãƒˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 30px;
        }

        .setting-group {
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 1px solid #eee;
        }

        .setting-group:last-child {
            border-bottom: none;
        }

        h2 {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 15px;
        }

        label {
            display: block;
            font-size: 1.1em;
            color: #666;
            margin-bottom: 8px;
        }

        input, select {
            width: 100%;
            padding: 12px;
            font-size: 1.1em;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .button {
            width: 100%;
            padding: 15px;
            font-size: 1.3em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 10px;
        }

        .save-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .back-button {
            background: #f0f0f0;
            color: #333;
        }

        .success-message {
            display: none;
            background: #4CAF50;
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }

        .time-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 id="pageTitle">âš™ï¸ è¨­å®š</h1>
        
        <div class="success-message" id="successMessage">
            è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ!
        </div>

        <form id="settingsForm">
            <!-- åŸºæœ¬æƒ…å ± -->
            <div class="setting-group">
                <h2>ğŸ‘¤ åŸºæœ¬æƒ…å ±</h2>
                <label>ãŠåå‰</label>
                <input type="text" id="userName" placeholder="ä¾‹ï¼šå±±ç”°å¤ªéƒ">
                
                <label>è‡ªå®…ä½æ‰€ï¼ˆå®¶ã«å¸°ã‚‹æ©Ÿèƒ½ã§ä½¿ç”¨ï¼‰</label>
                <input type="text" id="homeAddress" placeholder="ä¾‹ï¼šæ±äº¬éƒ½ã€‡ã€‡åŒºã€‡ã€‡1-2-3" autocomplete="street-address">
            </div>

            <!-- å®¶æ—é€£çµ¡å…ˆ -->
            <div class="setting-group">
                <h2>ğŸ“ å®¶æ—ã®é€£çµ¡å…ˆ</h2>
                <label>å®¶æ—1 - åå‰</label>
                <input type="text" id="family1Name" placeholder="ä¾‹ï¼šå±±ç”°èŠ±å­">
                
                <label>å®¶æ—1 - é›»è©±ç•ªå·</label>
                <input type="tel" id="family1Phone" placeholder="ä¾‹ï¼š090-1234-5678">
                
                <label>å®¶æ—2 - åå‰</label>
                <input type="text" id="family2Name" placeholder="ä¾‹ï¼šå±±ç”°æ¬¡éƒ">
                
                <label>å®¶æ—2 - é›»è©±ç•ªå·</label>
                <input type="tel" id="family2Phone" placeholder="ä¾‹ï¼š090-8765-4321">
                
                <label>å†™çœŸã®é€ä¿¡å…ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
                <input type="email" id="familyEmail" placeholder="ä¾‹ï¼šfamily@example.com">
            </div>

            <!-- ã‚¯ãƒªãƒ‹ãƒƒã‚¯æƒ…å ± -->
            <div class="setting-group">
                <h2>ğŸ¥ ã‚¯ãƒªãƒ‹ãƒƒã‚¯æƒ…å ±</h2>
                <label>ã‚¯ãƒªãƒ‹ãƒƒã‚¯å</label>
                <input type="text" id="clinicName" placeholder="ä¾‹ï¼šè„³ã¨ã“ã“ã‚ã®çŸ³åŸã‚¯ãƒªãƒ‹ãƒƒã‚¯" value="è„³ã¨ã“ã“ã‚ã®çŸ³åŸã‚¯ãƒªãƒ‹ãƒƒã‚¯">
                
                <label>ã‚¯ãƒªãƒ‹ãƒƒã‚¯é›»è©±ç•ªå·</label>
                <input type="tel" id="clinicPhone" placeholder="ä¾‹ï¼š022-123-4567">
            </div>

            <!-- æœè–¬æ™‚é–“ -->
            <div class="setting-group">
                <h2>ğŸ’Š ãŠè–¬ã®æ™‚é–“</h2>
                <div class="time-inputs">
                    <div>
                        <label>æœ</label>
                        <input type="time" id="medicineMorning" value="08:00">
                    </div>
                    <div>
                        <label>æ˜¼</label>
                        <input type="time" id="medicineLunch" value="12:00">
                    </div>
                    <div>
                        <label>å¤•æ–¹</label>
                        <input type="time" id="medicineEvening" value="18:00">
                    </div>
                    <div>
                        <label>å¤œ</label>
                        <input type="time" id="medicineNight" value="21:00">
                    </div>
                </div>
            </div>

            <!-- é€ä¿¡æ–¹æ³•ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ -->
            <div class="setting-group">
                <h2>ğŸ“¤ å†™çœŸã®é€ä¿¡æ–¹æ³•</h2>
                <label>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é€ä¿¡æ–¹æ³•</label>
                <select id="defaultSendMethod">
                    <option value="ask">æ¯å›é¸æŠã™ã‚‹</option>
                    <option value="line">LINE</option>
                    <option value="email">ãƒ¡ãƒ¼ãƒ«</option>
                </select>
            </div>

            <button type="submit" class="button save-button">ğŸ’¾ è¨­å®šã‚’ä¿å­˜</button>
            <button type="button" class="button back-button" onclick="goBack()">ğŸ  ã‚¢ãƒ—ãƒªã«æˆ»ã‚‹</button>
        </form>
    </div>

    <script>
        // è¨­å®šã‚’èª­ã¿è¾¼ã¿
        function loadSettings() {
            const settings = {
                userName: localStorage.getItem('userName') || '',
                homeAddress: localStorage.getItem('homeAddress') || '',
                family1Name: localStorage.getItem('family1Name') || '',
                family1Phone: localStorage.getItem('family1Phone') || '',
                family2Name: localStorage.getItem('family2Name') || '',
                family2Phone: localStorage.getItem('family2Phone') || '',
                familyEmail: localStorage.getItem('familyEmail') || '',
                clinicName: localStorage.getItem('clinicName') || 'è„³ã¨ã“ã“ã‚ã®çŸ³åŸã‚¯ãƒªãƒ‹ãƒƒã‚¯',
                clinicPhone: localStorage.getItem('clinicPhone') || '',
                medicineMorning: localStorage.getItem('medicineMorning') || '08:00',
                medicineLunch: localStorage.getItem('medicineLunch') || '12:00',
                medicineEvening: localStorage.getItem('medicineEvening') || '18:00',
                medicineNight: localStorage.getItem('medicineNight') || '21:00',
                defaultSendMethod: localStorage.getItem('defaultSendMethod') || 'ask'
            };

            Object.keys(settings).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.value = settings[key];
                }
            });
        }

        // è¨­å®šã‚’ä¿å­˜
        document.getElementById('settingsForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const fields = [
                'userName', 'homeAddress', 'family1Name', 'family1Phone',
                'family2Name', 'family2Phone', 'familyEmail', 'clinicName',
                'clinicPhone', 'medicineMorning', 'medicineLunch',
                'medicineEvening', 'medicineNight', 'defaultSendMethod'
            ];

            fields.forEach(field => {
                const value = document.getElementById(field).value;
                localStorage.setItem(field, value);
            });

            // åˆå›èµ·å‹•ã®å ´åˆã¯ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã¸
            const isFirstTime = localStorage.getItem('firstTime');
            if (isFirstTime === 'true') {
                localStorage.removeItem('firstTime');
                alert('è¨­å®šãŒå®Œäº†ã—ã¾ã—ãŸï¼\nã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¾ã™ã€‚');
                window.location.href = 'orientation-support-app.html';
                return;
            }

            // é€šå¸¸ã®ä¿å­˜ã®å ´åˆã‚‚ã‚¢ãƒ—ãƒªã«æˆ»ã‚‹
            const message = document.getElementById('successMessage');
            message.style.display = 'block';
            
            setTimeout(() => {
                window.location.href = 'orientation-support-app.html';
            }, 1500);
        });

        function goBack() {
            window.location.href = 'orientation-support-app.html';
        }

        // åˆæœŸåŒ–
        loadSettings();
        
        // åˆå›èµ·å‹•ãƒã‚§ãƒƒã‚¯
        const isFirstTime = localStorage.getItem('firstTime');
        if (isFirstTime === 'true') {
            document.getElementById('pageTitle').textContent = 'ğŸš€ åˆæœŸè¨­å®š';
            document.querySelector('.back-button').style.display = 'none';
            
            // èª¬æ˜ã‚’è¿½åŠ 
            const intro = document.createElement('div');
            intro.style.cssText = 'background: #e3f2fd; padding: 20px; border-radius: 10px; margin-bottom: 20px; text-align: center;';
            intro.innerHTML = `
                <p style="font-size: 1.2em; color: #1976d2; margin-bottom: 10px;">
                    <strong>ã‚ˆã†ã“ãï¼</strong>
                </p>
                <p style="color: #666;">
                    ã‚¢ãƒ—ãƒªã‚’ä½¿ã†å‰ã«ã€åŸºæœ¬æƒ…å ±ã‚’ç™»éŒ²ã—ã¾ã—ã‚‡ã†ã€‚<br>
                    å¾Œã‹ã‚‰å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
                </p>
            `;
            document.querySelector('.container').insertBefore(intro, document.getElementById('settingsForm'));
        }
    </script>
</body>
</html>
